.... ,0
こんにちは
れんだれーちゃん(仮)です
レンダラーの擬人化です
GPUにお願いして3Dモデルの描画をしてます
私がどんなふうに3Dモデルを描いてるか知ってますか？
....
しりませんよね... ,1
まあいいです ,0
今日は皆さんに3Dモデルがどのように色づけられているか知ってもらいます
そうですね...
とりあえず適当なモデルを表示してみましょうか
えい ,0 ,1
これが何のモデルかわかりますか？ ,0
.... ,1
答えは球体です ,0
え？ ,0
円にしか見えないですか? ,0
誤解です ,0
これは一切の影がついていない球です ,0
想像してみてください ,0
もし影の全くつかない物体があったとしたら、どのように見えるでしょうか ,0
.... ,1
影がつかなければその断面が現れます ,0
影絵を想像すると分かりやすいと思います ,0
球はどの方向から見ても断面が円になります ,0
ですから今ここに映っている影のない球は円に見えるわけです ,0
ただ... ,0
球を見せたいのに円が表示されてしまっては困ります... ,1
影を付けてみましょう ,0
えい ,0 ,1
球に見えるようなりました ,0
簡単にやりましたが、どうやって影を付けたか気になりませんか？ ,0
気になりますよね ,0
説明しましょう ,0
影を付けるためには光が必要です ,0
皆さんからは見えませんが、上空に1つのライトが設置してあります ,0
ライトは矢印の方向に光を発しています ,0 ,1
この矢印と逆方向のベクトルを光ベクトルとします ,0
影を付けるためには球の情報も必要です ,0
3Dモデルは法線ベクトルという情報を持っています ,0
これは面がどの方向を向いているのかを表すベクトルです ,0
例えばこの球でいうと... ,0
こんなかんじです ,0 ,1
実際にはもっと多くの法線ベクトルを持っていますが...
表示の都合上少なくしています ,0
2つのベクトルが真反対であれば面は光に対して垂直であるといえます ,0
この面と光の角度を求めるために、内積を使います ,0
内積は、言い換えれば2つのベクトルの一致度です ,0
内積によって面がどのくらい光の方向を向いているかがわかるのです ,0
各頂点でこの法線ベクトルと光のベクトルの内積を計算します ,0
ベクトルの長さを事前に処理することで内積の値は-1から1になります ,0
マイナスの値は使いづらいのでこの値にも処理を加え0から1にします ,0
内積の値が1に近づくほど光の良く当たる面ということになります
逆に0に近い面はほぼ光の当たらない面です
故にこの内積の値を影の強さとして扱うことができます
0に近ければ光の当たらない影の面
1に近ければ光に照らされる面といえます
これがCGの影の基本です
この影の付け方をランバート反射と呼んだりします
驚いたことにこれらはすべて高校数学の内容で説明できます ,0
すごいでしょう ,2
このように3Dモデルの色を決定する機能をshaderといいます ,0
shaderを書き換えてこの影をいじってみましょう ,0 ,1
最近アニメ調のCGがはやりですよね ,0
タイトルは出しませんがスマホゲームとかすごいですよね ,0
影のつき方をあんなかんじにしてみましょう ,0
先ほど内積の話をしました ,0
内積によってベクトルの一致度を測ることができます ,0
今の影の付け方はこの一致度をそのまま影に反映しているわけです ,0
ここに閾値を追加してみましょう ,0
つまり... ,0
内積が一定を超えれば元の色 ,0
越えなければ影の色 ,0
というふうにしてみましょう ,0
えい ,0 ,1
いっきにトゥーンになりましたね ,2
仕組みを確認しましょう ,0
内積を計算するまでは普通の影と同じです
内積を計算した後その値を閾値と比較し手影を決めます
実際の閾値を見てみましょう
スライダーで表示します ,0 ,1
スライダーを動かしてみてください
値を1に近づける程影の領域が大きくなるのがわかります
これをさらに拡張してみます
閾値を1つ増やせば影を2段階にすることができます
内積の値が閾値1以下の場合は影色1
内積の値が閾値2以下の場合は影色2
といった様にすれば影色を増やすことができます
やってみましょう
えい ,0 ,1
2つめの閾値も表示しました
1つめの閾値以下の値で自由に操作できます
だいぶそれっぽくなりましたね ,2
CGがどのように描画されるかということの... ,0
一端がお判りいただけたでしょうか
このshaderという機能ですが...
3Dモデルがどの色で描画されるかを決定することができます
3Dモデルのデータを受け取りそれを自由に処理できるため...
非常に柔軟な表現を可能にします
例えば...
こんなことや ,2 ,1
こんなこと ,2 ,1
果てにはこんな表現まで... ,2 ,1
こんなアーティスティックな表現が数学で表せる... ,0
とても面白いと思いませんか？ ,2
何でもできちゃいそうですよね
皆さんが普段何気なく触れている3DCGも... ,0
バックグラウンドを知れば非常に興味深いものになります
私の話で少しでもshaderに興味を持っていただければ幸いです
他にも語りたいことはたくさんあるのですが...
長くなりすぎますので... ,1
お付き合いいただきありがとうございました ,0
またどこかで.... ,0 ,1